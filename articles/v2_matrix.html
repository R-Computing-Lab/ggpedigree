<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing Relatedness Matrices with `ggRelatednessMatrix()` â€¢ ggpedigree</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Visualizing Relatedness Matrices with `ggRelatednessMatrix()`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggpedigree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v0_plots.html">Plotting pedigrees with `ggPedigree()`</a></li>
    <li><a class="dropdown-item" href="../articles/v1_interactiveplots.html">Interactive Pedigree Plotting with `ggPedigreeInteractive()`</a></li>
    <li><a class="dropdown-item" href="../articles/v2_matrix.html">Visualizing Relatedness Matrices with `ggRelatednessMatrix()`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/ggpedigree/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Visualizing Relatedness Matrices with `ggRelatednessMatrix()`</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/ggpedigree/blob/main/vignettes/v2_matrix.Rmd" class="external-link"><code>vignettes/v2_matrix.Rmd</code></a></small>
      <div class="d-none name"><code>v2_matrix.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to calculate and visualize relatedness
matrices for animal pedigrees using functions from the BGmisc and
ggpedigree packages. We focus on Kluane Red Squirrel Project data, but
the workflow generalizes to any pedigree dataset.</p>
<p>We will use the new ggRelatednessMatrix function to create
ggplot2-based heatmaps of relatedness matrices, inspired by the
approaches in the original squirrel population analyses.</p>
<div class="section level3">
<h3 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h3>
<p>First, load pedigree data and required libraries. The example data is
from the Kluane Red Squirrel Project, which has been running since 1987.
The data are available on Dryad at <a href="https://doi.org/10.5061/dryad.2z34tmpr3" class="external-link uri">https://doi.org/10.5061/dryad.2z34tmpr3</a>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span></span>
<span><span class="co"># Load the example data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"redsquirrels"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="calculating-relatedness-matrices">Calculating Relatedness Matrices<a class="anchor" aria-label="anchor" href="#calculating-relatedness-matrices"></a>
</h2>
<p>Here we show how to compute additive genetic and mitochondrial
relatedness matrices for a target family, as in the red squirrel
analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sumped</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/summarizePedigrees.html" class="external-link">summarizePedigrees</a></span><span class="op">(</span><span class="va">redsquirrels</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"personID"</span>,</span>
<span>  nbiggest <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Set target family for visualization</span></span>
<span><span class="va">fam_filter</span> <span class="op">&lt;-</span> <span class="va">sumped</span><span class="op">$</span><span class="va">biggest_families</span><span class="op">$</span><span class="va">famID</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Filter for the largest family, recode sex if needed</span></span>
<span><span class="va">ped_filtered</span> <span class="op">&lt;-</span> <span class="va">redsquirrels</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/recodeSex.html" class="external-link">recodeSex</a></span><span class="op">(</span>code_female <span class="op">=</span> <span class="st">"F"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">famID</span> <span class="op">==</span> <span class="va">fam_filter</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate relatedness matrices</span></span>
<span><span class="va">add_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2add.html" class="external-link">ped2add</a></span><span class="op">(</span><span class="va">ped_filtered</span>, isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">mit_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-computing-lab.github.io/BGmisc/reference/ped2mit.html" class="external-link">ped2mit</a></span><span class="op">(</span><span class="va">ped_filtered</span>, isChild_method <span class="op">=</span> <span class="st">"partialparent"</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizing-relatedness-matrices">Visualizing Relatedness Matrices<a class="anchor" aria-label="anchor" href="#visualizing-relatedness-matrices"></a>
</h2>
<p>The ggRelatednessMatrix function plots a relatedness matrix as a
heatmap, with options for clustering and color customization. This
approach mirrors the style of plots produced in the original red
squirrel data analysis.</p>
<div class="section level3">
<h3 id="plot-additive-genetic-relatedness">Plot additive genetic relatedness<a class="anchor" aria-label="anchor" href="#plot-additive-genetic-relatedness"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggRelatednessMatrix.html">ggRelatednessMatrix</a></span><span class="op">(</span></span>
<span>  <span class="va">add_mat</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    color_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>    scale_midpoint <span class="op">=</span> <span class="fl">0.55</span>,</span>
<span>    cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Additive Genetic Relatedness"</span>,</span>
<span>    text_size <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p_add</span></span></code></pre></div>
<p><img src="v2_matrix_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="plot-mitochondrial-relatedness">Plot mitochondrial relatedness<a class="anchor" aria-label="anchor" href="#plot-mitochondrial-relatedness"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_mit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggRelatednessMatrix.html">ggRelatednessMatrix</a></span><span class="op">(</span></span>
<span>  <span class="va">mit_mat</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    color_palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"skyblue"</span>, <span class="st">"darkblue"</span><span class="op">)</span>,</span>
<span>    scale_midpoint <span class="op">=</span> <span class="fl">0.55</span>,</span>
<span>    cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Mitochondrial Relatedness"</span>,</span>
<span>    text_size <span class="op">=</span> <span class="fl">6</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p_mit</span></span></code></pre></div>
<p><img src="v2_matrix_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="customization-options">Customization Options<a class="anchor" aria-label="anchor" href="#customization-options"></a>
</h2>
<p>You can adjust clustering, color scales, labels, and more using the
config list. For example, to turn off clustering:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_add_noclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggRelatednessMatrix.html">ggRelatednessMatrix</a></span><span class="op">(</span></span>
<span>  <span class="va">add_mat</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="cn">FALSE</span>, title <span class="op">=</span> <span class="st">"Additive Relatedness (No Clustering)"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p_add_noclust</span></span></code></pre></div>
<p><img src="v2_matrix_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="comparison-to-base-r-and-other-approaches">Comparison to Base R and Other Approaches<a class="anchor" aria-label="anchor" href="#comparison-to-base-r-and-other-approaches"></a>
</h2>
<p>For comparison, here is how the same matrix would be plotted in
corrplot, as in earlier squirrel analyses:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"corrplot"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html" class="external-link">corrplot</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">add_mat</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"color"</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"lower"</span>,</span>
<span>    col.lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.25</span><span class="op">)</span>,</span>
<span>    is.corr <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Additive Relatedness (Base R)"</span>,</span>
<span>    order <span class="op">=</span> <span class="st">"hclust"</span>,</span>
<span>    col <span class="op">=</span> <span class="fu">corrplot</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/COL1.html" class="external-link">COL1</a></span><span class="op">(</span><span class="st">"Reds"</span>, <span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="v2_matrix_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>The ggRelatednessMatrix function provides a flexible and visually
appealing way to explore patterns of genetic and mitochondrial
relatedness within families. This workflow integrates seamlessly with
tools from BGmisc and ggpedigree, supporting reproducible,
publication-quality visualization for quantitative genetic analysis.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
