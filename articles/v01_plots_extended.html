<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Extended Plotting pedigrees with ggPedigree() â€¢ ggpedigree</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extended Plotting pedigrees with ggPedigree()">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggpedigree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v00_plots.html">Plotting pedigrees with ggPedigree()</a></li>
    <li><a class="dropdown-item" href="../articles/v01_plots_extended.html">Extended Plotting pedigrees with ggPedigree()</a></li>
    <li><a class="dropdown-item" href="../articles/v10_interactiveplots.html">Interactive Pedigree Plotting with ggPedigreeInteractive</a></li>
    <li><a class="dropdown-item" href="../articles/v11_extendedinteractiveplots.html">Extended More Complex Pedigree Plots with ggPedigreeInteractive</a></li>
    <li><a class="dropdown-item" href="../articles/v20_matrix.html">Visualizing Relatedness Matrices with ggRelatednessMatrix()</a></li>
    <li><a class="dropdown-item" href="../articles/v21_phenotypicbydegree.html">Extended Plotting Phenotypic Correlation by Degree of Relatedness</a></li>
    <li><a class="dropdown-item" href="../articles/v22_plots_morecomplexity.html">Plotting more complicated pedigrees with `ggPedigree()`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/R-Computing-Lab/ggpedigree/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Extended Plotting pedigrees with ggPedigree()</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/R-Computing-Lab/ggpedigree/blob/main/vignettes/articles/v01_plots_extended.Rmd" class="external-link"><code>vignettes/articles/v01_plots_extended.Rmd</code></a></small>
      <div class="d-none name"><code>v01_plots_extended.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/ggpedigree/" class="external-link">ggpedigree</a></span><span class="op">)</span> <span class="co"># ggPedigree lives here</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span> <span class="co"># helper utilities &amp; example data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span> <span class="co"># ggplot2 for plotting</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span> <span class="co"># viridis for color palettes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># for data wrangling</span></span></code></pre></div>
<div class="section level2">
<h2 id="constructing-custom-pedigrees-for-publication">Constructing Custom Pedigrees for Publication<a class="anchor" aria-label="anchor" href="#constructing-custom-pedigrees-for-publication"></a>
</h2>
<p>Here we demonstrate how to create a custom pedigree using the
<code>ggpedigree package</code>. The data shown here were generated
using the <code><a href="https://r-computing-lab.github.io/BGmisc/reference/simulatePedigree.html" class="external-link">simulatePedigree()</a></code> function from the {BGmisc}
package, which is the parent package to {ggpedigree}. These simulated
pedigrees were used in a study evaluating statistical power and
estimation bias for a variance decomposition model that includes
mitochondrial DNA (mtDNA) effects.</p>
<p>The simulation generated thousands of extended pedigree structures
varying in depth, sibship size, mating structure, and maternal lineage
overlap. The example below shows one of the simulated pedigrees and is
the version included in the final manuscript:</p>
<blockquote>
<p>Detecting mtDNA effects with an Extended Pedigree Model: An Analysis
of Statistical Power and Estimation Bias Xuanyu Lyu, S. Alexandra Burt,
Michael D. Hunter, Rachel Good, Sarah L. Carroll, S. Mason Garrison
Preprint available at: <a href="https://doi.org/10.1101/2024.12.19.629449" class="external-link uri">https://doi.org/10.1101/2024.12.19.629449</a></p>
</blockquote>
<p>The structure includes multiple generations, sibling sets, and
overlapping parental lineages, and was chosen to illustrate the
complexity of the simulated pedigrees used in the power study.</p>
<div class="section level3">
<h3 id="preparing-the-data">Preparing the data<a class="anchor" aria-label="anchor" href="#preparing-the-data"></a>
</h3>
<p>Each row represents one individual. Variables include
<code>personID</code>, <code>momID</code>, <code>dadID</code>,
<code>sex</code>, and <code>famID</code>. The proband variable is
included to demonstrate status overlays. For plotting, we normalize
identifiers in family 1 to avoid ID collisions across families.</p>
<details><summary>
Click to expand pedigree setup
</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">pedigree_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">personID</span>, <span class="op">~</span><span class="va">momID</span>, <span class="op">~</span><span class="va">dadID</span>, <span class="op">~</span><span class="va">sex</span>, <span class="op">~</span><span class="va">famID</span>,</span>
<span>  <span class="fl">10011</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10012</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10021</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10022</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10023</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10024</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10025</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10026</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10027</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10031</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10032</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10033</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10034</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10035</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10036</span>, <span class="fl">10024</span>, <span class="fl">10022</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10037</span>, <span class="fl">10024</span>, <span class="fl">10022</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10038</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10039</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10310</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10311</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10312</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10011</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10012</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10021</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10022</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10023</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10024</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10025</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10026</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10027</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10031</span>, <span class="fl">10021</span>, <span class="fl">10023</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10032</span>, <span class="fl">10021</span>, <span class="fl">10023</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10033</span>, <span class="fl">10021</span>, <span class="fl">10023</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10034</span>, <span class="fl">10022</span>, <span class="fl">10025</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10035</span>, <span class="fl">10022</span>, <span class="fl">10025</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10036</span>, <span class="fl">10022</span>, <span class="fl">10025</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10310</span>, <span class="fl">10022</span>, <span class="fl">10025</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10037</span>, <span class="fl">10026</span>, <span class="fl">10027</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10038</span>, <span class="fl">10026</span>, <span class="fl">10027</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10039</span>, <span class="fl">10026</span>, <span class="fl">10027</span>, <span class="fl">0</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10311</span>, <span class="fl">10026</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">2</span>,</span>
<span>  <span class="fl">10312</span>, <span class="fl">10026</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">2</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    cleanpersonID <span class="op">=</span> <span class="va">personID</span> <span class="op">-</span> <span class="fl">10000</span>,</span>
<span>    personID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">famID</span> <span class="op">==</span> <span class="fl">1</span>, <span class="va">personID</span> <span class="op">-</span> <span class="fl">10000</span>, <span class="va">personID</span><span class="op">)</span>,</span>
<span>    momID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">famID</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">momID</span><span class="op">)</span>, <span class="va">momID</span> <span class="op">-</span> <span class="fl">10000</span>, <span class="va">momID</span><span class="op">)</span>,</span>
<span>    dadID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">famID</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">dadID</span><span class="op">)</span>, <span class="va">dadID</span> <span class="op">-</span> <span class="fl">10000</span>, <span class="va">dadID</span><span class="op">)</span>,</span>
<span>    proband <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">personID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">22</span>, <span class="fl">23</span>, <span class="fl">26</span>, <span class="fl">27</span>, <span class="fl">31</span>, <span class="fl">32</span>, <span class="fl">33</span>, <span class="fl">34</span>, <span class="fl">35</span><span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="va">personID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>        <span class="fl">10011</span>, <span class="fl">10022</span>, <span class="fl">10022</span>, <span class="fl">10023</span>, <span class="fl">10024</span>, <span class="fl">10026</span>,</span>
<span>        <span class="fl">10034</span>, <span class="fl">10035</span>, <span class="fl">10036</span>, <span class="fl">10310</span>,</span>
<span>        <span class="fl">10037</span>, <span class="fl">10038</span>, <span class="fl">10039</span>, <span class="fl">10311</span>,</span>
<span>        <span class="fl">10312</span></span>
<span>      <span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df_fig1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">personID</span>, <span class="op">~</span><span class="va">momID</span>, <span class="op">~</span><span class="va">dadID</span>, <span class="op">~</span><span class="va">sex</span>, <span class="op">~</span><span class="va">famID</span>,</span>
<span>  <span class="fl">10011</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10012</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10021</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10022</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10023</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10024</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10025</span>, <span class="fl">10011</span>, <span class="fl">10012</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10027</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10031</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10032</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10035</span>, <span class="fl">10023</span>, <span class="fl">10021</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10036</span>, <span class="fl">10024</span>, <span class="fl">10022</span>, <span class="fl">1</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10037</span>, <span class="fl">10024</span>, <span class="fl">10022</span>, <span class="fl">0</span>, <span class="fl">1</span>,</span>
<span>  <span class="fl">10038</span>, <span class="fl">10025</span>, <span class="fl">10027</span>, <span class="fl">1</span>, <span class="fl">1</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    proband <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">personID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10011</span>, <span class="fl">10022</span>, <span class="fl">10023</span>, <span class="fl">10025</span>, <span class="fl">10031</span>, <span class="fl">10032</span>, <span class="fl">10035</span>, <span class="fl">10038</span><span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span>,</span>
<span>    mtdnaline2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">personID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10024</span>, <span class="fl">10036</span>, <span class="fl">10037</span><span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span>,</span>
<span>  <span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="plotting-the-pedigree">Plotting the pedigree<a class="anchor" aria-label="anchor" href="#plotting-the-pedigree"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggPedigree.html">ggPedigree</a></span><span class="op">(</span></span>
<span>  <span class="va">df_fig1</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"personID"</span>,</span>
<span>  status_column <span class="op">=</span> <span class="st">"proband"</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    code_male <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    sex_color_include <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    apply_default_scales <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    label_method <span class="op">=</span> <span class="st">"geom_text"</span>,</span>
<span>    label_col <span class="op">=</span> <span class="st">"personID"</span>,</span>
<span>    point_size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    outline_include <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    status_code_affected <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    status_code_unaffected <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    generation_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    generation_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    status_affected_shape <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    segment_spouse_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_sibling_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_parent_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_offspring_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    outline_multiplier <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>    segment_linewidth <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Debug mode is ON. Debugging information will be printed.</span></span>
<span><span class="co">#&gt; Connections calculated. Number of connections: 14</span></span>
<span><span class="co"># fig1</span></span>
<span></span>
<span><span class="va">fig1</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_pos</span>, y <span class="op">=</span> <span class="va">y_pos</span><span class="op">)</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"cornflowerblue"</span>, size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  data <span class="op">=</span> <span class="va">fig1</span><span class="op">$</span><span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">mtdnaline2</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">15</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Unknown"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"white"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># discrete = TRUE,</span></span>
<span>  <span class="co"># labels = c("TRUE", "FALSE"),</span></span>
<span>  <span class="co">#  name = ""</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="v01_plots_extended_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggPedigree.html">ggPedigree</a></span><span class="op">(</span></span>
<span>  <span class="va">pedigree_df</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"personID"</span>,</span>
<span>  status_column <span class="op">=</span> <span class="st">"proband"</span>,</span>
<span>  <span class="co">#  debug = TRUE,</span></span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    code_male <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    sex_color_include <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    apply_default_scales <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    label_method <span class="op">=</span> <span class="st">"geom_text"</span>,</span>
<span>    label_include <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    label_column <span class="op">=</span> <span class="st">"cleanpersonID"</span>,</span>
<span>    status_code_affected <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    status_code_unaffected <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    generation_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    generation_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    status_affected_shape <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    segment_spouse_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_sibling_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_parent_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    segment_offspring_color <span class="op">=</span> <span class="st">"black"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We finish by adjusting the legend and shape scale for visual
clarity:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_shape_manual</a></span><span class="op">(</span></span>
<span>  values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">15</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Female"</span>, <span class="st">"Male"</span>, <span class="st">"Unknown"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_color_viridis</a></span><span class="op">(</span></span>
<span>    discrete <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TRUE"</span>, <span class="st">"FALSE"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"Founding MtDNA Line"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">famID</span>, scales <span class="op">=</span> <span class="st">"free"</span>, shrink <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    strip.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="v01_plots_extended_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="more-complex-pedigree-plots-with-ggpedigree">More Complex Pedigree Plots with ggPedigree<a class="anchor" aria-label="anchor" href="#more-complex-pedigree-plots-with-ggpedigree"></a>
</h2>
<p>In this section, we demonstrate how to create a more complex pedigree
plot with multiple families. We use the <code>inbreeding</code> dataset
from the <code>BGmisc</code> package, which contains several
multigenerational pedigrees with consanguinity. Note that in these plots
that some individuals may appear in multiple places within the pedigree.
This is common in large pedigrees, especially when there are overlapping
generations or multiple marriages. Here the colors are set to be the
same for all segments, except for self-loops, which are colored
purple.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/R-Computing-Lab/BGmisc/" class="external-link">BGmisc</a></span><span class="op">)</span> <span class="co"># helper utilities &amp; example data</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"inbreeding"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">inbreeding</span> <span class="co"># multigenerational pedigree with consanguinity</span></span>
<span></span>
<span></span>
<span><span class="co"># df  &lt;- dplyr::filter(df, famID %in% c(5, 7))</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggPedigree.html">ggPedigree</a></span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  famID <span class="op">=</span> <span class="st">"famID"</span>,</span>
<span>  personID <span class="op">=</span> <span class="st">"ID"</span>,</span>
<span>  status_column <span class="op">=</span> <span class="st">"proband"</span>,</span>
<span>  <span class="co">#  debug = TRUE,</span></span>
<span>  config <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    code_male <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    sex_color_include <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    status_code_affected <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    status_code_unaffected <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    generation_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    point_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    generation_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    status_affected_shape <span class="op">=</span> <span class="fl">4</span>,</span>
<span>    segment_self_color <span class="op">=</span> <span class="st">"purple"</span>,</span>
<span>    segment_self_linewidth <span class="op">=</span> <span class="fl">.5</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">famID</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="co">#+ scale_color_viridis(</span></span></code></pre></div>
<p><img src="v01_plots_extended_files/figure-html/self-loops-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#   discrete = TRUE,</span></span>
<span><span class="co">#   labels = c("TRUE", "FALSE")</span></span>
<span><span class="co">#  )  + theme_bw(base_size = 14)  +  guides(colour="none", shape="none")</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by S. Mason Garrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
